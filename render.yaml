# render.yaml
# Final Blueprint using ONLY a Web Service that serves everything.

services:
  # This single service handles the API AND the frontend dashboard
  - type: web
    name: webhosting- # This should match the name of your Web Service on Render
    env: node
    plan: free
    branch: main
    
    # Build and Start Commands for the Node.js server
    buildCommand: "npm install"
    startCommand: "node server.js"
    
    # Disk for storing deployed websites
    disks:
      - name: deployments
        mountPath: /opt/render/project/src/deployments
        sizeGB: 1
      - name: uploads
        mountPath: /opt/render/project/src/uploads
        sizeGB: 1
        
    # Environment Variables
    envVars:
      - key: MONGO_URI
        fromDatabase:
          name: platform-db # Must match the database name below
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: DOMAIN_NAME
        fromService:
          type: web
          name: webhosting- # MUST match the 'name' of this service
          property: host

# The Database (MongoDB)
databases:
  - name: platform-db
    plan: free
